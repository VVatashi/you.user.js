// ==UserScript==
// @name        (You)
// @include     *
// @version     0.1.7
// @grant       GM_getValue
// @grant       GM_setValue
// @require     https://code.jquery.com/jquery-3.6.0.min.js
// @run-at      document-end
// @namespace   https://github.com/VVatashi
// @downloadURL https://raw.githubusercontent.com/VVatashi/-You-/master/build/you.user.js
// @updateURL   https://raw.githubusercontent.com/VVatashi/-You-/master/build/you.user.js
// ==/UserScript==

!function o(r,a,i){function s(n,t){if(!a[n]){if(!r[n]){var e="function"==typeof require&&require;if(!t&&e)return e(n,!0);if(c)return c(n,!0);throw(e=new Error("Cannot find module '"+n+"'")).code="MODULE_NOT_FOUND",e}e=a[n]={exports:{}},r[n][0].call(e.exports,function(t){return s(r[n][1][t]||t)},e,e.exports,o,r,a,i)}return a[n].exports}for(var c="function"==typeof require&&require,t=0;t<i.length;t++)s(i[t]);return s}({1:[function(t,n,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Config=void 0;var o=(r.save=function(t){GM_setValue(r.localStorageKey,JSON.stringify(t))},r.load=function(){return JSON.parse(GM_getValue(r.localStorageKey,JSON.stringify(r.default)))},r.default=new r("Name","!Trip","{ box-shadow: 6px 0 2px -2px rgba(97,107,134,.8), -6px 0 2px -2px rgba(97,107,134,.8); }","{ box-shadow: 6px 0 2px -2px rgba(157,47,208,.8), -6px 0 2px -2px rgba(157,47,208,.8); }",":after { content: ' (You)'; }"),r.localStorageKey="you-config",r);function r(t,n,e,o,r){this.name=t,this.trip=n,this.myPostStyle=e,this.replyPostStyle=o,this.replyLinkStyle=r}e.Config=o},{}],2:[function(t,n,e){"use strict";var o,r=this&&this.__extends||(o=function(t,n){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])})(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}o(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)});Object.defineProperty(e,"__esModule",{value:!0}),e.ImageBoard=void 0;var a=(i.prototype.getAdminBar=function(){return $(this.adminBarSelector).first()},i.prototype.getPosts=function(){return $(this.postSelector)},i.prototype.getPostSubject=function(t){return t.find(this.postSubjectelector).text()},i.prototype.getPostName=function(t){return t.find(this.postNameSelector).text()},i.prototype.getPostTripcode=function(t){return t.find(this.postTripSelector).text()},i.prototype.getPostBody=function(t){return t.find(this.postBodySelector)},i.prototype.getPostBodyText=function(t){return this.getPostBody(t).text()},i.prototype.getPostBodyLinks=function(t){return this.getPostBody(t).find("a")},i.prototype.getName=function(){return this.name},i.detect=function(){return!1},i);function i(t,n,e,o,r,a,i){this.name=t,this.adminBarSelector=n,this.postSelector=e,this.postSubjectelector=o,this.postNameSelector=r,this.postTripSelector=a,this.postBodySelector=i}e.ImageBoard=a;var s,c=(r(p,s=a),p.detect=function(){return $("p.footer").text().contains("hanabira",!0)},p);function p(){return s.call(this,"Hanabira","div.adminbar","td.reply[id]","span.replytitle","span.postername","span.postertrip","div.message")||this}var l,u=(r(d,l=a),d.detect=function(){return $("body").hasClass("makaba")},d);function d(){return l.call(this,"Makaba","div#adminbar","div.post[id]","span.post-title","span.ananimas","span.postertrip","blockquote")||this}var f,y=(r(m,f=a),m.detect=function(){return $("footer").text().contains("tinyboard",!0)},m);function m(){return f.call(this,"Tinyboard","div.boardlist","div.post[id]","span.subject","span.name","span.trip","div.body")||this}var g,v=(r(h,g=a),h.detect=function(){return $("footer").text().contains("tinyib",!0)},h);function h(){return g.call(this,"TinyIB","div.adminbar","td.reply[id], div.post[id]","span.filetitle","span.postername","span.postertrip","div.message")||this}var b,x=(r(S,b=a),S.detect=function(){return $("footer").text().contains("monaba",!0)},S);function S(){return b.call(this,"Monaba","div#control-panel","div.post[id]","span.reply-title","span.poster-name","span.poster-trip","div.message")||this}var P,k=(r(_,P=a),_.detect=function(){return $("footer").text().contains("phutaba",!0)},_);function _(){return P.call(this,"Phutaba","ul.menu","div.thread_OP[id], div.thread_reply[id]","span.subject","span.postername","span.tripcode","div.post_body")||this}var B,C=(r(O,B=a),O.detect=function(){return 0<$("script[src]").filter(function(t,n){return $(n).attr("src").contains("ochoba",!0)}).length},O);function O(){return B.call(this,"Ochoba","div.adminbar","td.reply[id]","span.replytitle","span.commentpostername","span.postertrip","blockquote")||this}var w,N=(r(T,w=a),T.detect=function(){return 0<$("script[src]").filter(function(t,n){return $(n).attr("src").contains("wakaba",!0)}).length},T);function T(){return w.call(this,"Wakaba","div.adminbar, div#adminbar","td.reply[id]","span.filetitle","span.postername, span.commentpostername","span.postertrip","blockquote")||this}var j,I=(r(M,j=a),M.detect=function(){return 0<$("script[src]").filter(function(t,n){return $(n).attr("src").contains("kusaba",!0)}).length},M);function M(){return j.call(this,"Kusaba","div.adminbar","td.reply[id], div.reply[id]","span.filetitle","span.postername","span.postertrip","blockquote")||this}(a=e.ImageBoard||(e.ImageBoard={})).GetImageBoard=function(){for(var t=[c,u,y,v,x,k,C,N,I],n=0;n<t.length;n++)if(t[n].detect())return new t[n];return null},e.ImageBoard=a},{}],3:[function(t,n,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var c,p=t("./config"),o=t("./imageboard"),l="you-modal-container",r="you-style",u="you-config-form",d="you-config-form",f="you-processed",y="you-post-my",m="you-post-reply",g="you-post-reply-link",v=p.Config.default,h=[];function b(){$("#"+r).remove();var t=document.createElement("style");t.id=r,t.type="text/css",t.innerHTML="\n.".concat(y).concat(v.myPostStyle,"\n\n.").concat(m).concat(v.replyPostStyle,"\n\n.").concat(g).concat(v.replyLinkStyle,"\n\ndiv.").concat(l," {\n    position: fixed;\n    top: 0;\n    bottom: 0;\n    left: 0;\n    right: 0;\n    background: rgba(0, 0, 0, 0.7);\n    transition: opacity 500ms;\n    visibility: hidden;\n    opacity: 0;\n}\n\ndiv.").concat(l,":target {\n    visibility: visible;\n    opacity: 1;\n}\n\nform.").concat(d," {\n    margin: 70px auto;\n    padding: 20px;\n    background-color: white;\n    border-radius: 5px;\n    width: 30%;\n    position: relative;\n    transition: all 5s ease-in-out;\n    text-align: justify;\n    z-index: 1000;\n}\n\nform.").concat(d," table, form.").concat(d," p, form.").concat(d," input, form.").concat(d," textarea {\n    color: black;\n    background-color: white;\n    width: 100%;\n}\n\nform.").concat(d," input, form.").concat(d," textarea {\n    border: solid 1px;\n}\n\nform.").concat(d," tr {\n    width: 100%;\n}"),document.head.appendChild(t)}function a(){var t="you-config-name",n="you-config-trip",e="you-config-mypost-style",o="you-config-replypost-style",r="you-config-replylink-style",a="you-config-save",i="you-config-default",s=c.getAdminBar();(s=!s||0==s.length?$("body"):s).append('\n[ <a class="'.concat("you-config-toogle",'" href="#').concat(u,'">(You) config</a> ]\n<div id="').concat(u,'" class="').concat(l,'">\n    <form class="').concat(d,'">\n        <table>\n            <tr>\n                <td>Name:</td>\n                <td><input type="text" class="').concat(t,'" value="').concat(v.name,'" /></td>\n            </tr>\n            <tr>\n                <td>Trip:</td>\n                <td><input type="text" class="').concat(n,'" value="').concat(v.trip,'" /></td>\n            </tr>\n            <tr>\n                <td>My post css:</td>\n                <td><textarea class="').concat(e,'">').concat(v.myPostStyle,'</textarea></td>\n            </tr>\n            <tr>\n                <td>Reply post css:</td>\n                <td><textarea class="').concat(o,'">').concat(v.replyPostStyle,'</textarea></td>\n            </tr>\n            <tr>\n                <td>Reply link css:</td>\n                <td><textarea class="').concat(r,'">').concat(v.replyLinkStyle,'</textarea></td>\n            </tr>\n            <tr>\n                <td colspan="2" style="text-align: center;">\n                    <button class="').concat(a,'">Ok</button>\n                    <button class="').concat(i,'">Restore defaults</button>\n                </td>\n            </tr>\n        </table>\n    </form>\n</div>\n')),$("button."+a).click(function(){return v.name=$("input."+t).val().toString(),v.trip=$("input."+n).val().toString(),v.myPostStyle=$("textarea."+e).val().toString(),v.replyPostStyle=$("textarea."+o).val().toString(),v.replyLinkStyle=$("textarea."+r).val().toString(),p.Config.save(v),$("."+f).removeClass(f),$("."+y).removeClass(y),$("."+m).removeClass(m),$("."+g).removeClass(g),h=[],b(),x(),!(window.location.href="#")}),$("button."+i).click(function(){return v=p.Config.default,$("input."+t).val(v.name),$("input."+n).val(v.trip),$("textarea."+e).val(v.myPostStyle),$("textarea."+o).val(v.replyPostStyle),$("textarea."+r).val(v.replyLinkStyle),p.Config.save(v),!1})}function x(){var t=c.getPosts().not("."+f),n=t.filter(function(t,n){var e=c.getPostName($(n)),n=c.getPostTripcode($(n));return e.contains(v.name)&&n.contains(v.trip)});n.addClass(y);n=n.map(function(t,n){return $(n).attr("id").match(/\d+/)[0]}).toArray();h=h.concat(n);n=t.filter(function(t,n){for(var e=c.getPostBodyText($(n)),o=0;o<h.length;o++)if(e.contains(">>"+h[o]))return!0;return!1});n.addClass(m),c.getPostBodyLinks(n).each(function(t,n){for(var e=$(n).text(),o=0;o<h.length;o++)if(e==">>"+h[o])return void $(n).addClass(g)}),t.addClass(f)}$(document).ready(function(){(c=o.ImageBoard.GetImageBoard())?(console.log("[You] imageboard detected as "+c.getName()),v=p.Config.load(),b(),a(),x(),setInterval(x,1e4)):console.log("[You] imageboard not detected")})},{"./config":1,"./imageboard":2}],4:[function(t,n,e){"function"!=typeof String.prototype.contains&&(String.prototype.contains=function(t,n){return(n=void 0===n?!1:n)?-1!=this.toUpperCase().indexOf(t.toUpperCase()):-1!=this.indexOf(t)})},{}]},{},[3,4]);