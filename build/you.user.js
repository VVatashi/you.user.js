// ==UserScript==
// @name        (You)
// @include     *
// @version     0.1.6
// @grant       GM_getValue
// @grant       GM_setValue
// @require     http://code.jquery.com/jquery-3.1.1.min.js
// @run-at      document-end
// @namespace   https://github.com/VVatashi
// @downloadURL https://raw.githubusercontent.com/VVatashi/-You-/master/build/you.user.js
// @updateURL   https://raw.githubusercontent.com/VVatashi/-You-/master/build/you.user.js
// ==/UserScript==

!function t(n,e,o){function r(a,s){if(!e[a]){if(!n[a]){var c="function"==typeof require&&require;if(!s&&c)return c(a,!0);if(i)return i(a,!0);var u=new Error("Cannot find module '"+a+"'");throw u.code="MODULE_NOT_FOUND",u}var p=e[a]={exports:{}};n[a][0].call(p.exports,function(t){var e=n[a][1][t];return r(e?e:t)},p,p.exports,t,n,e,o)}return e[a].exports}for(var i="function"==typeof require&&require,a=0;a<o.length;a++)r(o[a]);return r}({1:[function(t,n,e){"use strict";var o=function(){function t(t,n,e,o,r){this.name=t,this.trip=n,this.myPostStyle=e,this.replyPostStyle=o,this.replyLinkStyle=r}return t.save=function(n){GM_setValue(t.localStorageKey,JSON.stringify(n))},t.load=function(){return JSON.parse(GM_getValue(t.localStorageKey,JSON.stringify(t.default)))},t.default=new t("Name","!Trip","{ box-shadow: 6px 0 2px -2px rgba(97,107,134,.8), -6px 0 2px -2px rgba(97,107,134,.8); }","{ box-shadow: 6px 0 2px -2px rgba(157,47,208,.8), -6px 0 2px -2px rgba(157,47,208,.8); }",":after { content: ' (You)'; }"),t.localStorageKey="you-config",t}();e.Config=o},{}],2:[function(t,n,e){"use strict";var o=this&&this.__extends||function(t,n){function e(){this.constructor=t}for(var o in n)n.hasOwnProperty(o)&&(t[o]=n[o]);t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)},r=function(){function t(t,n,e,o,r,i,a){this.name=t,this.adminBarSelector=n,this.postSelector=e,this.postSubjectelector=o,this.postNameSelector=r,this.postTripSelector=i,this.postBodySelector=a}return t.prototype.getAdminBar=function(){return $(this.adminBarSelector).first()},t.prototype.getPosts=function(){return $(this.postSelector)},t.prototype.getPostSubject=function(t){return t.find(this.postSubjectelector).text()},t.prototype.getPostName=function(t){return t.find(this.postNameSelector).text()},t.prototype.getPostTripcode=function(t){return t.find(this.postTripSelector).text()},t.prototype.getPostBody=function(t){return t.find(this.postBodySelector)},t.prototype.getPostBodyText=function(t){return this.getPostBody(t).text()},t.prototype.getPostBodyLinks=function(t){return this.getPostBody(t).find("a")},t.prototype.getName=function(){return this.name},t.detect=function(){return!1},t}();e.ImageBoard=r;var r,i=function(t){function n(){t.call(this,"Hanabira","div.adminbar","td.reply[id]","span.replytitle","span.postername","span.postertrip","div.message")}return o(n,t),n.detect=function(){return $("p.footer").text().contains("hanabira",!0)},n}(r),a=function(t){function n(){t.call(this,"Makaba","div#adminbar","div.post[id]","span.post-title","span.ananimas","span.postertrip","blockquote")}return o(n,t),n.detect=function(){return $("body").hasClass("makaba")},n}(r),s=function(t){function n(){t.call(this,"Tinyboard","div.boardlist","div.post[id]","span.subject","span.name","span.trip","div.body")}return o(n,t),n.detect=function(){return $("footer").text().contains("tinyboard",!0)},n}(r),c=function(t){function n(){t.call(this,"TinyIB","div.adminbar","td.reply[id], div.post[id]","span.filetitle","span.postername","span.postertrip","div.message")}return o(n,t),n.detect=function(){return $("footer").text().contains("tinyib",!0)},n}(r),u=function(t){function n(){t.call(this,"Monaba","div#control-panel","div.post[id]","span.reply-title","span.poster-name","span.poster-trip","div.message")}return o(n,t),n.detect=function(){return $("footer").text().contains("monaba",!0)},n}(r),p=function(t){function n(){t.call(this,"Phutaba","ul.menu","div.thread_OP[id], div.thread_reply[id]","span.subject","span.postername","span.tripcode","div.post_body")}return o(n,t),n.detect=function(){return $("footer").text().contains("phutaba",!0)},n}(r),l=function(t){function n(){t.call(this,"Ochoba","div.adminbar","td.reply[id]","span.replytitle","span.commentpostername","span.postertrip","blockquote")}return o(n,t),n.detect=function(){return $("script[src]").filter(function(t,n){return $(n).attr("src").contains("ochoba",!0)}).length>0},n}(r),d=function(t){function n(){t.call(this,"Wakaba","div.adminbar, div#adminbar","td.reply[id]","span.filetitle","span.postername, span.commentpostername","span.postertrip","blockquote")}return o(n,t),n.detect=function(){return $("script[src]").filter(function(t,n){return $(n).attr("src").contains("wakaba",!0)}).length>0},n}(r),f=function(t){function n(){t.call(this,"Kusaba","div.adminbar","td.reply[id], div.reply[id]","span.filetitle","span.postername","span.postertrip","blockquote")}return o(n,t),n.detect=function(){return $("script[src]").filter(function(t,n){return $(n).attr("src").contains("kusaba",!0)}).length>0},n}(r);!function(t){function n(){for(var t=[i,a,s,c,u,p,l,d,f],n=0;n<t.length;n++)if(t[n].detect())return new t[n];return null}t.GetImageBoard=n}(r=e.ImageBoard||(e.ImageBoard={}))},{}],3:[function(t,n,e){"use strict";function o(){$("."+y).removeClass(y),$("."+m).removeClass(m),$("."+g).removeClass(g),$("."+v).removeClass(v),h=[],r(),a()}function r(){$("#"+l).remove();var t=document.createElement("style");t.id=l,t.type="text/css",t.innerHTML="\n."+m+b.myPostStyle+"\n\n."+g+b.replyPostStyle+"\n\n."+v+b.replyLinkStyle+"\n\ndiv."+p+" {\n    position: fixed;\n    top: 0;\n    bottom: 0;\n    left: 0;\n    right: 0;\n    background: rgba(0, 0, 0, 0.7);\n    transition: opacity 500ms;\n    visibility: hidden;\n    opacity: 0;\n}\n\ndiv."+p+":target {\n    visibility: visible;\n    opacity: 1;\n}\n\nform."+f+" {\n    margin: 70px auto;\n    padding: 20px;\n    background-color: white;\n    border-radius: 5px;\n    width: 30%;\n    position: relative;\n    transition: all 5s ease-in-out;\n    text-align: justify;\n    z-index: 1000;\n}\n\nform."+f+" table, form."+f+" p, form."+f+" input, form."+f+" textarea {\n    color: black;\n    background-color: white;\n    width: 100%;\n}\n\nform."+f+" input, form."+f+" textarea {\n    border: solid 1px;\n}\n\nform."+f+" tr {\n    width: 100%;\n}",document.head.appendChild(t)}function i(){var t="you-config-name",n="you-config-trip",e="you-config-mypost-style",r="you-config-replypost-style",i="you-config-replylink-style",a="you-config-toogle",u="you-config-save",l="you-config-default",y=s.getAdminBar();y&&0!=y.length||(y=$("body")),y.append('\n[ <a class="'+a+'" href="#'+d+'">(You) config</a> ]\n<div id="'+d+'" class="'+p+'">\n    <form class="'+f+'">\n        <table>\n            <tr>\n                <td>Name:</td>\n                <td><input type="text" class="'+t+'" value="'+b.name+'" /></td>\n            </tr>\n            <tr>\n                <td>Trip:</td>\n                <td><input type="text" class="'+n+'" value="'+b.trip+'" /></td>\n            </tr>\n            <tr>\n                <td>My post css:</td>\n                <td><textarea class="'+e+'">'+b.myPostStyle+'</textarea></td>\n            </tr>\n            <tr>\n                <td>Reply post css:</td>\n                <td><textarea class="'+r+'">'+b.replyPostStyle+'</textarea></td>\n            </tr>\n            <tr>\n                <td>Reply link css:</td>\n                <td><textarea class="'+i+'">'+b.replyLinkStyle+'</textarea></td>\n            </tr>\n            <tr>\n                <td colspan="2" style="text-align: center;">\n                    <button class="'+u+'">Ok</button>\n                    <button class="'+l+'">Restore defaults</button>\n                </td>\n            </tr>\n        </table>\n    </form>\n</div>\n'),$("button."+u).click(function(){return b.name=$("input."+t).val(),b.trip=$("input."+n).val(),b.myPostStyle=$("textarea."+e).val(),b.replyPostStyle=$("textarea."+r).val(),b.replyLinkStyle=$("textarea."+i).val(),c.Config.save(b),o(),window.location.href="#",!1}),$("button."+l).click(function(){return b=c.Config.default,$("input."+t).val(b.name),$("input."+n).val(b.trip),$("textarea."+e).val(b.myPostStyle),$("textarea."+r).val(b.replyPostStyle),$("textarea."+i).val(b.replyLinkStyle),c.Config.save(b),!1})}function a(){var t=s.getPosts().not("."+y),n=t.filter(function(t,n){var e=s.getPostName($(n)),o=s.getPostTripcode($(n));return e.contains(b.name)&&o.contains(b.trip)});n.addClass(m);var e=$.map(n,function(t,n){return $(t).attr("id").match(/\d+/)[0]});h=h.concat(e);var o=t.filter(function(t,n){for(var e=s.getPostBodyText($(n)),o=0;o<h.length;o++)if(e.contains(">>"+h[o]))return!0;return!1});o.addClass(g),s.getPostBodyLinks(o).each(function(t,n){for(var e=$(n).text(),o=0;o<h.length;o++)if(e==">>"+h[o])return void $(n).addClass(v)}),t.addClass(y)}var s,c=t("./config"),u=t("./imageboard"),p="you-modal-container",l="you-style",d="you-config-form",f="you-config-form",y="you-processed",m="you-post-my",g="you-post-reply",v="you-post-reply-link",b=c.Config.default,h=[];$(document).ready(function(){return(s=u.ImageBoard.GetImageBoard())?(console.log("[You] imageboard detected as "+s.getName()),b=c.Config.load(),r(),i(),a(),void setInterval(a,1e4)):void console.log("[You] imageboard not detected")})},{"./config":1,"./imageboard":2}],4:[function(t,n,e){var o;!function(t){"function"!=typeof String.prototype.contains&&(String.prototype.contains=function(t,n){return void 0===n&&(n=!1),n?this.toUpperCase().indexOf(t.toUpperCase())!=-1:this.indexOf(t)!=-1})}(o||(o={}))},{}]},{},[3,4]);
//# sourceMappingURL=you.user.js.map
